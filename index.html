<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn Typing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <script>
        const goodSound = new Audio('./good.mp3')
        const badSound = new Audio('./bad.mp3')
        function generateKey(keys) {
            keys = keys
            const number = Math.floor(Math.random() * keys.length);
            const key = keys[number];
            return key;
        }

        function handleKeypress(e, prevKey) {

        }
    </script>
</head>

<body class="bg-neutral-950 h-screen text-white">
    <div class="w-full h-full flex justify-center align-middle place-items-center"
        x-data="{key: '', pressed: '', wrong: false, sec: 0, time: '0 seconds', trainKeys: localStorage.getItem('keys')||''}">
        <template x-if="trainKeys.length == 0">
            <div class="flex flex-col gap-4 justify-center align-middle place-items-center max-w-2xl w-full" x-data="{keysToTrain:'0123456789abcdefghijklmnopqrstuvwxyz;,./'}">
                <h2 class="text-3xl text-gray-600">Enter Keys To Train</h2>
                <input x-model="keysToTrain" type="text"
                    class="p-2 w-full rounded-2xl text-lg outline-none border-none text-gray-500 text-center font-bold bg-gray-800">
                <button class="w-1/3 bg-green-500 p-2 rounded-2xl" x-on:click="()=>{
                    localStorage.setItem('keys', keysToTrain)
                    trainKeys = keysToTrain
                }">start training</button>
            </div>
        </template>
        <template x-if="trainKeys.length > 0">
            <div class="flex justify-center flex-col gap-8 relative" x-init="()=>{key=generateKey(trainKeys)}">
                <h1 class="text-9xl text-white text-center" x-text="key"></h1>
                <input class="p-4 border-2 outline-none text-center flex bg-gray-900 w-[100px] rounded-2xl text-3xl "
                    :class="wrong ? 'border-red-500 text-white': 'border-gray-700 text-gray-600'" @keydown="(e)=>{
                const pressedKey = e.key
                pressed = ''
                if (pressedKey.length > 1) return key
                const now = new Date().getTime();
                if (sec > 0){
                    const secondsElapsed = (now - sec) / 1000;
                    time = `${secondsElapsed} seconds`
                }
                sec = now
                if (pressedKey != key) {
                    wrong=true
                    pressed = ''
                    badSound.play();
                    return
                }
                wrong=false
                pressed = ''
                key= generateKey(trainKeys, key)

        }" x-model="pressed" />
                <div class="flex flex-col gap-4">

                    <p class="w-full whitespace-nowrap text-center text-green-400" x-text="time"></p>

                    <button class="text-gray-700" x-on:click="()=>{
                        delete localStorage['keys']
                        trainKeys = ''
                        pressed=''
                        key=''
                    }">change keys</button>
                </div>
            </div>
        </template>
    </div>


</body>

</html>